<!DOCTYPE html>
<html lang="en">
  <head>
    <!-- Required meta tags for BootStrap -->
    <meta charset="utf-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1, shrink-to-fit=no"
    />

    <!-- Required stylesheet for React -->
    <link
      rel="stylesheet"
      href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css"
      integrity="sha384-JcKb8q3iqJ61gNV9KGb8thSsNjpSL0n8PARn9HuZOnIxN0hoP+VmmDGMN5t9UJ0Z"
      crossorigin="anonymous"
    />
    <!-- Required stylesheet of Us -->
    <!--link rel="stylesheet" type="text/css" href="demostyle.css" /-->
    <style>
      .bd-placeholder-img {
        font-size: 1.125rem;
        text-anchor: middle;
        -webkit-user-select: none;
        -moz-user-select: none;
        -ms-user-select: none;
        user-select: none;
      }

      @media (min-width: 768px) {
        .bd-placeholder-img-lg {
          font-size: 3.5rem;
        }
      }
    </style>
    <!-- Custom styles for this template -->
    <!--link href="signin.css" rel="stylesheet" /-->
  </head>
  <body class="text-center">
    <script src="//mozilla.github.io/pdf.js/build/pdf.js"></script>

    <h1>PDF.js Previous/Next example</h1>

    <div>
      <button id="prev">Previous</button>
      <button id="next">Next</button>
      &nbsp; &nbsp;
      <span
        >Page: <span id="page_num"></span> / <span id="page_count"></span
      ></span>
    </div>

    <canvas id="the-canvas"></canvas>

    <form class="form-signin">
      <img
        class="mb-4"
        src="https://www.flaticon.com/svg/static/icons/svg/1917/1917710.svg"
        alt=""
        width="72"
        height="72"
      />
      <h1 class="h3 mb-3 font-weight-normal">Please sign in</h1>
      <label for="inputEmail" class="sr-only">Email address</label>
      <input
        type="email"
        id="inputEmail"
        class="form-control"
        placeholder="Email address"
        required
        autofocus
      />
      <label for="inputPassword" class="sr-only">Password</label>
      <input
        type="password"
        id="inputPassword"
        class="form-control"
        placeholder="Password"
        required
      />
      <div class="checkbox mb-3">
        <label>
          <input type="checkbox" value="remember-me" /> Remember me
        </label>
      </div>
      <button
        id="signinBtn"
        class="btn btn-lg btn-primary btn-block"
        type="submit"
      >
        Sign in
      </button>
      <p class="mt-5 mb-3 text-muted">&copy; 2017-2020</p>
    </form>

    <!-- Load React. -->
    <!-- Note: when deploying, replace "development.js" with "production.min.js". -->
    <!--script
      src="https://unpkg.com/react@16/umd/react.development.js"
      crossorigin
    ></script>
    <script
      src="https://unpkg.com/react-dom@16/umd/react-dom.development.js"
      crossorigin
    ></script-->

    <!-- Load React component. -->
    <!--script src="like_button.js"></script-->

    <!-- Load BootStrap components. -->
    <script
      src="https://code.jquery.com/jquery-3.5.1.slim.min.js"
      integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj"
      crossorigin="anonymous"
    ></script>
    <script
      src="https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js"
      integrity="sha384-9/reFTGAW83EW2RDu2S0VKaIzap3H66lZH81PoYlFhbGU+6BZp6G7niu735Sk7lN"
      crossorigin="anonymous"
    ></script>
    <script
      src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"
      integrity="sha384-B4gt1jrGC7Jh4AgTPSdUtOBvfO8shuf57BaghqFfPlYxofvL8/KUEfYiJOMMV+rV"
      crossorigin="anonymous"
    ></script>
    <!--script src="signin.js"></script-->
    <!--script>
      // If absolute URL from the remote server is provided, configure the CORS
      // header on that server.
      var url =
        "https://raw.githubusercontent.com/mozilla/pdf.js/ba2edeae/web/compressed.tracemonkey-pldi-09.pdf";

      // Loaded via <script> tag, create shortcut to access PDF.js exports.
      var pdfjsLib = window["pdfjs-dist/build/pdf"];

      // The workerSrc property shall be specified.
      pdfjsLib.GlobalWorkerOptions.workerSrc =
        "//mozilla.github.io/pdf.js/build/pdf.worker.js";

      var pdfDoc = null,
        pageNum = 1,
        pageRendering = false,
        pageNumPending = null,
        scale = 0.8,
        canvas = document.getElementById("the-canvas"),
        ctx = canvas.getContext("2d");

      /**
       * Get page info from document, resize canvas accordingly, and render page.
       * @param num Page number.
       */
      function renderPage(num) {
        pageRendering = true;
        // Using promise to fetch the page
        pdfDoc.getPage(num).then(function (page) {
          var viewport = page.getViewport({ scale: scale });
          canvas.height = viewport.height;
          canvas.width = viewport.width;

          // Render PDF page into canvas context
          var renderContext = {
            canvasContext: ctx,
            viewport: viewport,
          };
          var renderTask = page.render(renderContext);

          // Wait for rendering to finish
          renderTask.promise.then(function () {
            pageRendering = false;
            if (pageNumPending !== null) {
              // New page rendering is pending
              renderPage(pageNumPending);
              pageNumPending = null;
            }
          });
        });

        // Update page counters
        document.getElementById("page_num").textContent = num;
      }

      /**
       * If another page rendering in progress, waits until the rendering is
       * finised. Otherwise, executes rendering immediately.
       */
      function queueRenderPage(num) {
        if (pageRendering) {
          pageNumPending = num;
        } else {
          renderPage(num);
        }
      }

      /**
       * Displays previous page.
       */
      function onPrevPage() {
        if (pageNum <= 1) {
          return;
        }
        pageNum--;
        queueRenderPage(pageNum);
      }
      document.getElementById("prev").addEventListener("click", onPrevPage);

      /**
       * Displays next page.
       */
      function onNextPage() {
        if (pageNum >= pdfDoc.numPages) {
          return;
        }
        pageNum++;
        queueRenderPage(pageNum);
      }
      document.getElementById("next").addEventListener("click", onNextPage);

      /**
       * Asynchronously downloads PDF.
       */
      pdfjsLib.getDocument(url).promise.then(function (pdfDoc_) {
        pdfDoc = pdfDoc_;
        document.getElementById("page_count").textContent = pdfDoc.numPages;

        // Initial/first page rendering
        renderPage(pageNum);
      });
    </script-->

    <script>
      // If absolute URL from the remote server is provided, configure the CORS
      // header on that server.
      //
      // var urls = [
      //   "http://mozilla.github.io/pdf.js/web/compressed.tracemonkey-pldi-09.pdf",
      //   "http://mozilla.github.io/pdf.js/web/compressed.tracemonkey-pldi-09.pdf",
      // ];

      var urls = [
        "https://partner.shopeemobile.com/api/v1/logistics/download_shipping_document?token=nDcQJ%2Frx7GUX69YR64%2FYi6smrEudO7fQv7p%2FOU4Z7rmLhyzMRVTJOxDYx5F7EIOnGd5KVZT2nHGjZZh2XpeubDAOvue5bFQcvd1DoFeF0Kppx9vYFyf2%2BlfW9QnSwhrwhPhbDu%2FUC7hIfRNCuHgtD9ggPhiS8It73ZG4QwyuB%2BfQxC1%2BTPXoQh0uXBLpLXBy5e%2FC2nS%2BZIQegf8W5Ec7yv%2FBFj6zOg%2BHlaboc4nW2hpApYI8WJaUcWMjVlY%2BHHZx1H1TNefgNOCUTidRJZmBw6VKJJr25AcNQ%2B1NXcZ5Wml%2BWq4e3MQP87rUjD9mwDNPZ4stLQlYhtJvXpAVZzgvzg%3D%3D",
        "https://partner.shopeemobile.com/api/v1/logistics/download_shipping_document?token=nDcQJ%2Frx7GUX69YR64%2FYi6smrEudO7fQv7p%2FOU4Z7rmLhyzMRVTJOxDYx5F7EIOnGd5KVZT2nHGjZZh2XpeubDAOvue5bFQcvd1DoFeF0Kppx9vYFyf2%2BlfW9QnSwhrwhPhbDu%2FUC7hIfRNCuHgtD9ggPhiS8It73ZG4QwyuB%2BfQxC1%2BTPXoQh0uXBLpLXBy5e%2FC2nS%2BZIQegf8W5Ec7yv%2FBFj6zOg%2BHlaboc4nW2hpApYI8WJaUcWMjVlY%2BHHZx1H1TNefgNOCUTidRJZmBw6VKJJr25AcNQ%2B1NXcZ5Wml%2BWq4e3MQP87rUjD9mwDNPZ4stLQlYhtJvXpAVZzgvzg%3D%3D",
      ];
      // Disable workers to avoid yet another cross-origin issue (workers need
      // the URL of the script to be loaded, and dynamically loading a cross-origin
      // script does not work).
      //
      // pdfjsLib.disableWorker = true;

      // In cases when the pdf.worker.js is located at the different folder than the
      // pdf.js's one, or the pdf.js is executed via eval(), the workerSrc property
      // shall be specified.
      //
      // pdfjsLib.workerSrc = 'pdf.worker.js';

      /**
       * @typedef {Object} PageInfo
       * @property {number} documentIndex
       * @property {number} pageNumber
       */

      var pdfDocs = [],
        /**
         * @property {PageInfo}
         */
        current = {},
        totalPageCount = 0,
        pageNum = 1,
        pageRendering = false,
        pageNumPending = null,
        scale = 0.8,
        canvas = document.getElementById("the-canvas"),
        ctx = canvas.getContext("2d");

      /**
       * Get page info from document, resize canvas accordingly, and render page.
       * @param num Page number.
       */
      function renderPage(num) {
        pageRendering = true;
        current = getPageInfo(num);
        // Using promise to fetch the page
        pdfDocs[current.documentIndex]
          .getPage(current.pageNumber)
          .then(function (page) {
            var viewport = page.getViewport({ scale: scale });
            canvas.height = viewport.height;
            canvas.width = viewport.width;

            // Render PDF page into canvas context
            var renderContext = {
              canvasContext: ctx,
              viewport: viewport,
            };
            var renderTask = page.render(renderContext);

            // Wait for rendering to finish
            renderTask.promise.then(function () {
              pageRendering = false;
              if (pageNumPending !== null) {
                // New page rendering is pending
                renderPage(pageNumPending);
                pageNumPending = null;
              }
            });
          });

        // Update page counters
        document.getElementById("page_num").textContent = pageNum;
      }

      /**
       * If another page rendering in progress, waits until the rendering is
       * finished. Otherwise, executes rendering immediately.
       */
      function queueRenderPage(num) {
        if (pageRendering) {
          pageNumPending = num;
        } else {
          renderPage(num);
        }
      }

      /**
       * Displays previous page.
       */
      function onPrevPage() {
        if (pageNum <= 1) {
          return;
        }
        pageNum--;
        queueRenderPage(pageNum);
      }

      document.getElementById("prev").addEventListener("click", onPrevPage);

      /**
       * Displays next page.
       */
      function onNextPage() {
        if (
          pageNum >= totalPageCount &&
          current.documentIndex + 1 === pdfDocs.length
        ) {
          return;
        }

        pageNum++;
        queueRenderPage(pageNum);
      }

      document.getElementById("next").addEventListener("click", onNextPage);

      /**
       * @returns PageNumber
       */
      function getPageInfo(num) {
        let totalPageCount = 0;

        for (let i = 0; i < pdfDocs.length; i++) {
          let currentCount = pdfDocs[i].numPages;
          totalPageCount += currentCount;
          if (num <= totalPageCount) {
            return {
              documentIndex: i,
              pageNumber: currentCount - (totalPageCount - num),
            };
          }
        }

        return false;
      }

      function getTotalPageCount() {
        var totalPageCount = 0;
        for (var docIdx = 0; docIdx < pdfDocs.length; docIdx++) {
          totalPageCount += pdfDocs[docIdx].numPages;
        }
        return totalPageCount;
      }

      var loadedCount = 0;

      function load() {
        // Load PDFs one after another
        pdfjsLib
          .getDocument(urls[loadedCount])
          .promise.then(function (pdfDoc_) {
            console.log("loaded PDF " + loadedCount);
            pdfDocs.push(pdfDoc_);
            loadedCount++;
            if (loadedCount !== urls.length) {
              return load();
            }

            console.log("Finished loading");
            totalPageCount = getTotalPageCount();
            document.getElementById("page_count").textContent = totalPageCount;

            // Initial/first page rendering
            renderPage(pageNum);
          });
      }

      load();
    </script>
  </body>
</html>
